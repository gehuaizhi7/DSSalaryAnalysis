---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Results
```{r echo=FALSE}
# Basics
if(!require(dplyr)) install.packages("dplyr")
if(!require(tibble)) install.packages("tibble")
if(!require(tidyr)) install.packages("tidyr")
if(!require(ggplot2)) install.packages("ggplot2")
if(!require(forcats)) install.packages("forcats")
if(!require(patchwork)) install.packages("patchwork")
if(!require(scales)) install.packages("scales")
if(!require(readr)) install.packages("readr")
if(!require(ggthemes)) install.packages("ggthemes")
if(!require(ggrepel)) install.packages("ggrepel")
if(!require(GGally)) install.packages("GGally")
if(!require(plotly)) install.packages("plotly")
if(!require(forcats)) install.packages("forcats")
if(!require(stringr)) install.packages("stringr")

if(!require(ggpubr)) install.packages("ggpubr")
if(!require(PupillometryR)) install.packages("PupillometryR")
if(!require(ggridges)) install.packages("ggridges")
if(!require(RColorBrewer)) install.packages("RColorBrewer")
if(!require(magrittr)) install.packages("magrittr") # allow %<>%

if(!require(vcd)) install.packages("vcd")
if(!require(d3r)) install.packages("d3r")
if(!require(ggalluvial)) install.packages("ggalluvial")
if(!require(parcoords)) install.packages("parcoords")

# pair plot
if(!require(gridGraphics)) install.packages("gridGraphics")
if(!require(gridExtra)) install.packages("gridExtra")

library("data.table")
library(mi)
```

```{r echo=FALSE}
install.packages("stopwords")
library("stopwords")
library(tidyverse)
library(tidytext)
library("wordcloud")
library("wordcloud2")
library(textstem)
library(rmarkdown)

library("readxl")

```


## wordcloud
```{r}
skill_count <- read_excel("data/skill_count.xlsx")
```


```{r}
skill_count %>% 
  arrange(-freq) %>% 
  ungroup() %>% 
  as.data.frame() -> df_word

rownames(df_word) <- df_word$Tech
wordcloud2(df_word , size = 2, shape = 'movie') 
```

## mosaic

---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Results
```{r echo=FALSE}
# Basics
if(!require(dplyr)) install.packages("dplyr")
if(!require(tibble)) install.packages("tibble")
if(!require(tidyr)) install.packages("tidyr")
if(!require(ggplot2)) install.packages("ggplot2")
if(!require(forcats)) install.packages("forcats")
if(!require(patchwork)) install.packages("patchwork")
if(!require(scales)) install.packages("scales")
if(!require(readr)) install.packages("readr")
if(!require(ggthemes)) install.packages("ggthemes")
if(!require(ggrepel)) install.packages("ggrepel")
if(!require(GGally)) install.packages("GGally")
if(!require(plotly)) install.packages("plotly")
if(!require(forcats)) install.packages("forcats")
if(!require(stringr)) install.packages("stringr")

if(!require(ggpubr)) install.packages("ggpubr")
if(!require(PupillometryR)) install.packages("PupillometryR")
if(!require(ggridges)) install.packages("ggridges")
if(!require(RColorBrewer)) install.packages("RColorBrewer")
if(!require(magrittr)) install.packages("magrittr") # allow %<>%

if(!require(vcd)) install.packages("vcd")
if(!require(d3r)) install.packages("d3r")
if(!require(ggalluvial)) install.packages("ggalluvial")
if(!require(parcoords)) install.packages("parcoords")

# pair plot
if(!require(gridGraphics)) install.packages("gridGraphics")
if(!require(gridExtra)) install.packages("gridExtra")

library("data.table")
library(mi)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(gridExtra)
if(!require(GGally)) install.packages("GGally")
if(!require(Lock5withR)) install.packages("Lock5withR")
library(plotly)
if(!require(ggalluvial)) install.packages("ggalluvial")
if(!require(d3r)) install.packages("d3r")
if(!require(parcoords)) install.packages("parcoords")
if(!require(vcd)) install.packages("vcd")
```

```{r echo=FALSE}
install.packages("stopwords")
library("stopwords")
library(tidyverse)
library(tidytext)
library("wordcloud")
library("wordcloud2")
library(textstem)
library(rmarkdown)
if(!require(dplyr)) install.packages("dplyr")
library("dplyr")
library("readxl")

```


## Frequency of skill sets 
```{r}
data <- read_excel("data/clean_data.xlsx")
```



```{r}
data %>%
  drop_na(Revenue) %>%
  mutate(revenue_level = case_when(
      Revenue =="$10+ billion (USD)" ~ "High(>1b)",
      Revenue =="$5 to $10 billion (USD)" ~ "High(>1b)",
      Revenue =="$2 to $5 billion (USD)" ~ "High(>1b)",
      Revenue =="$1 to $2 billion (USD)" ~ "High(>1b)",
      Revenue =="$500 million to $1 billion (USD)" ~ "Mid(25m~1b)",
      Revenue =="$100 to $500 million (USD)" ~ "Mid(25m~1b)",
      Revenue =="$50 to $100 million (USD)" ~ "Mid(25m~1b)",
      Revenue =="$25 to $50 million (USD)" ~ "Mid(25m~1b)",
      Revenue =="$10 to $25 million (USD)" ~ "Low(<25m)",
      Revenue =="$5 to $10 million (USD)" ~ "Low(<25m)",
      Revenue =="$1 to $5 million (USD)" ~ "Low(<25m)",
      Revenue =="Less than $1 million (USD)" ~ "Low(<25m)"
    )) -> data_revenue

```

```{r}
data_revenue %>% 
  drop_na(`Avg_salary(k)`) %>%
  mutate(salary_group = if_else(`Avg_salary(k)`>100,"High(>100k)",
                            if_else(`Avg_salary(k)`<80,"low(<90K)","medium(80~100K)"))) -> data_revenue_salary
```




```{r}
data_revenue_salary %>% 
  mutate(salary_group = factor(salary_group,levels = c("High(>100k)","medium(80~100K)","low(<90K)"))) %>% 
  mutate(revenue_level = factor(revenue_level,levels = c("Low(<25m)","Mid(25m~1b)","High(>1b)"))) %>% 
  vcd::mosaic(salary_group~revenue_level, .,
              shade = TRUE,
              direction = c("v","h"),
              highlighting_fill = RColorBrewer::brewer.pal(3, "Blues"),
              spacing = vcd::spacing_dimequal(c(.3, 0, 0)),
              labeling = labeling_border(tl_labels = c(FALSE, TRUE),
                                       rot_labels = c(0, 0, 0, 0),
                                       offset_varnames = c(0,0,0,2),
                                       offset_labels = c(0,0,0,1)),
             main = "Employee Salary Group v.s. Company Revenue Level")
```




